/*! For license information please see main.66245bb96c76708b5e53.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdateimmersive_website("main",{"./app/components/Canvas/Media.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r("./node_modules/ogl/src/core/Program.js");r("./app/shaders/plane-fragment.glsl"),r("./app/shaders/plane-vertex.glsl");const n=class{constructor({element:e}){this.element=e}createTexture(){}createProgram(){this.Program=new s.Program}createMesh(){}}},"./node_modules/ogl/src/core/Program.js":(e,t,r)=>{r.r(t),r.d(t,{Program:()=>a});var s=r("./node_modules/console-browserify/index.js");let n=1;const i={};class a{constructor(e,{vertex:t,fragment:r,uniforms:i={},transparent:a=!1,cullFace:o=e.BACK,frontFace:l=e.CCW,depthTest:c=!0,depthWrite:u=!0,depthFunc:g=e.LESS}={}){e.canvas||s.error("gl not passed as fist argument to Program"),this.gl=e,this.uniforms=i,this.id=n++,t||s.warn("vertex shader not supplied"),r||s.warn("fragment shader not supplied"),this.transparent=a,this.cullFace=o,this.frontFace=l,this.depthTest=c,this.depthWrite=u,this.depthFunc=g,this.blendFunc={},this.blendEquation={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA));const d=e.createShader(e.VERTEX_SHADER);e.shaderSource(d,t),e.compileShader(d),""!==e.getShaderInfoLog(d)&&s.warn(`${e.getShaderInfoLog(d)}\nVertex Shader\n${h(t)}`);const m=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(m,r),e.compileShader(m),""!==e.getShaderInfoLog(m)&&s.warn(`${e.getShaderInfoLog(m)}\nFragment Shader\n${h(r)}`),this.program=e.createProgram(),e.attachShader(this.program,d),e.attachShader(this.program,m),e.linkProgram(this.program),!e.getProgramParameter(this.program,e.LINK_STATUS))return s.warn(e.getProgramInfoLog(this.program));e.deleteShader(d),e.deleteShader(m),this.uniformLocations=new Map;let f=e.getProgramParameter(this.program,e.ACTIVE_UNIFORMS);for(let t=0;t<f;t++){let r=e.getActiveUniform(this.program,t);this.uniformLocations.set(r,e.getUniformLocation(this.program,r.name));const s=r.name.match(/(\w+)/g);r.uniformName=s[0],3===s.length?(r.isStructArray=!0,r.structIndex=Number(s[1]),r.structProperty=s[2]):2===s.length&&isNaN(Number(s[1]))&&(r.isStruct=!0,r.structProperty=s[1])}this.attributeLocations=new Map;const p=[],F=e.getProgramParameter(this.program,e.ACTIVE_ATTRIBUTES);for(let t=0;t<F;t++){const r=e.getActiveAttrib(this.program,t),s=e.getAttribLocation(this.program,r.name);-1!==s&&(p[s]=r.name,this.attributeLocations.set(r,s))}this.attributeOrder=p.join("")}setBlendFunc(e,t,r,s){this.blendFunc.src=e,this.blendFunc.dst=t,this.blendFunc.srcAlpha=r,this.blendFunc.dstAlpha=s,e&&(this.transparent=!0)}setBlendEquation(e,t){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=t}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha)}use({flipFaces:e=!1}={}){let t=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach(((e,r)=>{let s=r.uniformName,n=this.uniforms[s];if(r.isStruct&&(n=n[r.structProperty],s+=`.${r.structProperty}`),r.isStructArray&&(n=n[r.structIndex][r.structProperty],s+=`[${r.structIndex}].${r.structProperty}`),!n)return c(`Active uniform ${s} has not been supplied`);if(n&&void 0===n.value)return c(`${s} uniform is missing a value parameter`);if(n.value.texture)return t+=1,n.value.update(t),o(this.gl,r.type,e,t);if(n.value.length&&n.value[0].texture){const s=[];return n.value.forEach((e=>{t+=1,e.update(t),s.push(t)})),o(this.gl,r.type,e,s)}o(this.gl,r.type,e,n.value)})),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function o(e,t,r,s){s=s.length?function(e){const t=e.length,r=e[0].length;if(void 0===r)return e;const s=t*r;let n=i[s];n||(i[s]=n=new Float32Array(s));for(let s=0;s<t;s++)n.set(e[s],s*r);return n}(s):s;const n=e.renderer.state.uniformLocations.get(r);if(s.length)if(void 0===n||n.length!==s.length)e.renderer.state.uniformLocations.set(r,s.slice(0));else{if(function(e,t){if(e.length!==t.length)return!1;for(let r=0,s=e.length;r<s;r++)if(e[r]!==t[r])return!1;return!0}(n,s))return;n.set?n.set(s):function(e,t){for(let r=0,s=e.length;r<s;r++)e[r]=t[r]}(n,s),e.renderer.state.uniformLocations.set(r,n)}else{if(n===s)return;e.renderer.state.uniformLocations.set(r,s)}switch(t){case 5126:return s.length?e.uniform1fv(r,s):e.uniform1f(r,s);case 35664:return e.uniform2fv(r,s);case 35665:return e.uniform3fv(r,s);case 35666:return e.uniform4fv(r,s);case 35670:case 5124:case 35678:case 35680:return s.length?e.uniform1iv(r,s):e.uniform1i(r,s);case 35671:case 35667:return e.uniform2iv(r,s);case 35672:case 35668:return e.uniform3iv(r,s);case 35673:case 35669:return e.uniform4iv(r,s);case 35674:return e.uniformMatrix2fv(r,!1,s);case 35675:return e.uniformMatrix3fv(r,!1,s);case 35676:return e.uniformMatrix4fv(r,!1,s)}}function h(e){let t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}let l=0;function c(e){l>100||(s.warn(e),l++,l>100&&s.warn("More than 100 program warnings - stopping logs."))}}},(function(e){e.h=()=>"5031c614812ee96904ef"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBUXlELElBQzlCdUIsRUFBTXZCLEdBQUtBLEVBQUksRUFBSSxLQUFPdUIsRUFBTXZCLEdBRXBDLE9BQU91QixFQUFNL0QsS0FBSyxLQUNyQixDQTJCRCxJQUFJZ0UsRUFBWSxFQUNoQixTQUFTeEgsRUFBS3lILEdBQ05ELEVBQVksTUFDaEIzSCxFQUFRRyxLQUFLeUgsR0FDYkQsSUFDSUEsRUFBWSxLQUFLM0gsRUFBUUcsS0FBSyxtREFDckMsaUJDbFREMEgsRUFBb0JDLEVBQUksSUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2ltbWVyc2l2ZS13ZWJzaXRlLy4vYXBwL2NvbXBvbmVudHMvQ2FudmFzL01lZGlhLmpzIiwid2VicGFjazovL2ltbWVyc2l2ZS13ZWJzaXRlLy4vbm9kZV9tb2R1bGVzL29nbC9zcmMvY29yZS9Qcm9ncmFtLmpzIiwid2VicGFjazovL2ltbWVyc2l2ZS13ZWJzaXRlL3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXh0dXJlLCBQcm9ncmFtLCBNZXNoIH0gZnJvbSAnb2dsJ1xuXG5pbXBvcnQgZnJhZ21lbnQgZnJvbSAnc2hhZGVycy9wbGFuZS1mcmFnbWVudC5nbHNsJ1xuaW1wb3J0IHZlcnRleCBmcm9tICdzaGFkZXJzL3BsYW5lLXZlcnRleC5nbHNsJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB7XG5cdGNvbnN0cnVjdG9yKHsgZWxlbWVudCB9KSB7XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudFxuXHR9XG5cblx0Y3JlYXRlVGV4dHVyZSgpIHt9XG5cblx0Y3JlYXRlUHJvZ3JhbSgpIHtcbiAgICB0aGlzLlByb2dyYW0gPSBuZXcgUHJvZ3JhbSgpXG4gIH1cblxuXHRjcmVhdGVNZXNoKCkge31cbn1cbiIsIi8vIFRPRE86IHVwbG9hZCBlbXB0eSB0ZXh0dXJlIGlmIG51bGwgPyBtYXliZSBub3Rcbi8vIFRPRE86IHVwbG9hZCBpZGVudGl0eSBtYXRyaXggaWYgbnVsbCA/XG4vLyBUT0RPOiBzYW1wbGVyIEN1YmVcblxubGV0IElEID0gMTtcblxuLy8gY2FjaGUgb2YgdHlwZWQgYXJyYXlzIHVzZWQgdG8gZmxhdHRlbiB1bmlmb3JtIGFycmF5c1xuY29uc3QgYXJyYXlDYWNoZUYzMiA9IHt9O1xuXG5leHBvcnQgY2xhc3MgUHJvZ3JhbSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGdsLFxuICAgICAgICB7XG4gICAgICAgICAgICB2ZXJ0ZXgsXG4gICAgICAgICAgICBmcmFnbWVudCxcbiAgICAgICAgICAgIHVuaWZvcm1zID0ge30sXG5cbiAgICAgICAgICAgIHRyYW5zcGFyZW50ID0gZmFsc2UsXG4gICAgICAgICAgICBjdWxsRmFjZSA9IGdsLkJBQ0ssXG4gICAgICAgICAgICBmcm9udEZhY2UgPSBnbC5DQ1csXG4gICAgICAgICAgICBkZXB0aFRlc3QgPSB0cnVlLFxuICAgICAgICAgICAgZGVwdGhXcml0ZSA9IHRydWUsXG4gICAgICAgICAgICBkZXB0aEZ1bmMgPSBnbC5MRVNTLFxuICAgICAgICB9ID0ge31cbiAgICApIHtcbiAgICAgICAgaWYgKCFnbC5jYW52YXMpIGNvbnNvbGUuZXJyb3IoJ2dsIG5vdCBwYXNzZWQgYXMgZmlzdCBhcmd1bWVudCB0byBQcm9ncmFtJyk7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy51bmlmb3JtcyA9IHVuaWZvcm1zO1xuICAgICAgICB0aGlzLmlkID0gSUQrKztcblxuICAgICAgICBpZiAoIXZlcnRleCkgY29uc29sZS53YXJuKCd2ZXJ0ZXggc2hhZGVyIG5vdCBzdXBwbGllZCcpO1xuICAgICAgICBpZiAoIWZyYWdtZW50KSBjb25zb2xlLndhcm4oJ2ZyYWdtZW50IHNoYWRlciBub3Qgc3VwcGxpZWQnKTtcblxuICAgICAgICAvLyBTdG9yZSBwcm9ncmFtIHN0YXRlXG4gICAgICAgIHRoaXMudHJhbnNwYXJlbnQgPSB0cmFuc3BhcmVudDtcbiAgICAgICAgdGhpcy5jdWxsRmFjZSA9IGN1bGxGYWNlO1xuICAgICAgICB0aGlzLmZyb250RmFjZSA9IGZyb250RmFjZTtcbiAgICAgICAgdGhpcy5kZXB0aFRlc3QgPSBkZXB0aFRlc3Q7XG4gICAgICAgIHRoaXMuZGVwdGhXcml0ZSA9IGRlcHRoV3JpdGU7XG4gICAgICAgIHRoaXMuZGVwdGhGdW5jID0gZGVwdGhGdW5jO1xuICAgICAgICB0aGlzLmJsZW5kRnVuYyA9IHt9O1xuICAgICAgICB0aGlzLmJsZW5kRXF1YXRpb24gPSB7fTtcblxuICAgICAgICAvLyBzZXQgZGVmYXVsdCBibGVuZEZ1bmMgaWYgdHJhbnNwYXJlbnQgZmxhZ2dlZFxuICAgICAgICBpZiAodGhpcy50cmFuc3BhcmVudCAmJiAhdGhpcy5ibGVuZEZ1bmMuc3JjKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nbC5yZW5kZXJlci5wcmVtdWx0aXBsaWVkQWxwaGEpIHRoaXMuc2V0QmxlbmRGdW5jKHRoaXMuZ2wuT05FLCB0aGlzLmdsLk9ORV9NSU5VU19TUkNfQUxQSEEpO1xuICAgICAgICAgICAgZWxzZSB0aGlzLnNldEJsZW5kRnVuYyh0aGlzLmdsLlNSQ19BTFBIQSwgdGhpcy5nbC5PTkVfTUlOVVNfU1JDX0FMUEhBKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbXBpbGUgdmVydGV4IHNoYWRlciBhbmQgbG9nIGVycm9yc1xuICAgICAgICBjb25zdCB2ZXJ0ZXhTaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIoZ2wuVkVSVEVYX1NIQURFUik7XG4gICAgICAgIGdsLnNoYWRlclNvdXJjZSh2ZXJ0ZXhTaGFkZXIsIHZlcnRleCk7XG4gICAgICAgIGdsLmNvbXBpbGVTaGFkZXIodmVydGV4U2hhZGVyKTtcbiAgICAgICAgaWYgKGdsLmdldFNoYWRlckluZm9Mb2codmVydGV4U2hhZGVyKSAhPT0gJycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgJHtnbC5nZXRTaGFkZXJJbmZvTG9nKHZlcnRleFNoYWRlcil9XFxuVmVydGV4IFNoYWRlclxcbiR7YWRkTGluZU51bWJlcnModmVydGV4KX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbXBpbGUgZnJhZ21lbnQgc2hhZGVyIGFuZCBsb2cgZXJyb3JzXG4gICAgICAgIGNvbnN0IGZyYWdtZW50U2hhZGVyID0gZ2wuY3JlYXRlU2hhZGVyKGdsLkZSQUdNRU5UX1NIQURFUik7XG4gICAgICAgIGdsLnNoYWRlclNvdXJjZShmcmFnbWVudFNoYWRlciwgZnJhZ21lbnQpO1xuICAgICAgICBnbC5jb21waWxlU2hhZGVyKGZyYWdtZW50U2hhZGVyKTtcbiAgICAgICAgaWYgKGdsLmdldFNoYWRlckluZm9Mb2coZnJhZ21lbnRTaGFkZXIpICE9PSAnJykge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGAke2dsLmdldFNoYWRlckluZm9Mb2coZnJhZ21lbnRTaGFkZXIpfVxcbkZyYWdtZW50IFNoYWRlclxcbiR7YWRkTGluZU51bWJlcnMoZnJhZ21lbnQpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29tcGlsZSBwcm9ncmFtIGFuZCBsb2cgZXJyb3JzXG4gICAgICAgIHRoaXMucHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcbiAgICAgICAgZ2wuYXR0YWNoU2hhZGVyKHRoaXMucHJvZ3JhbSwgdmVydGV4U2hhZGVyKTtcbiAgICAgICAgZ2wuYXR0YWNoU2hhZGVyKHRoaXMucHJvZ3JhbSwgZnJhZ21lbnRTaGFkZXIpO1xuICAgICAgICBnbC5saW5rUHJvZ3JhbSh0aGlzLnByb2dyYW0pO1xuICAgICAgICBpZiAoIWdsLmdldFByb2dyYW1QYXJhbWV0ZXIodGhpcy5wcm9ncmFtLCBnbC5MSU5LX1NUQVRVUykpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oZ2wuZ2V0UHJvZ3JhbUluZm9Mb2codGhpcy5wcm9ncmFtKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgc2hhZGVyIG9uY2UgbGlua2VkXG4gICAgICAgIGdsLmRlbGV0ZVNoYWRlcih2ZXJ0ZXhTaGFkZXIpO1xuICAgICAgICBnbC5kZWxldGVTaGFkZXIoZnJhZ21lbnRTaGFkZXIpO1xuXG4gICAgICAgIC8vIEdldCBhY3RpdmUgdW5pZm9ybSBsb2NhdGlvbnNcbiAgICAgICAgdGhpcy51bmlmb3JtTG9jYXRpb25zID0gbmV3IE1hcCgpO1xuICAgICAgICBsZXQgbnVtVW5pZm9ybXMgPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHRoaXMucHJvZ3JhbSwgZ2wuQUNUSVZFX1VOSUZPUk1TKTtcbiAgICAgICAgZm9yIChsZXQgdUluZGV4ID0gMDsgdUluZGV4IDwgbnVtVW5pZm9ybXM7IHVJbmRleCsrKSB7XG4gICAgICAgICAgICBsZXQgdW5pZm9ybSA9IGdsLmdldEFjdGl2ZVVuaWZvcm0odGhpcy5wcm9ncmFtLCB1SW5kZXgpO1xuICAgICAgICAgICAgdGhpcy51bmlmb3JtTG9jYXRpb25zLnNldCh1bmlmb3JtLCBnbC5nZXRVbmlmb3JtTG9jYXRpb24odGhpcy5wcm9ncmFtLCB1bmlmb3JtLm5hbWUpKTtcblxuICAgICAgICAgICAgLy8gc3BsaXQgdW5pZm9ybXMnIG5hbWVzIHRvIHNlcGFyYXRlIGFycmF5IGFuZCBzdHJ1Y3QgZGVjbGFyYXRpb25zXG4gICAgICAgICAgICBjb25zdCBzcGxpdCA9IHVuaWZvcm0ubmFtZS5tYXRjaCgvKFxcdyspL2cpO1xuXG4gICAgICAgICAgICB1bmlmb3JtLnVuaWZvcm1OYW1lID0gc3BsaXRbMF07XG5cbiAgICAgICAgICAgIGlmIChzcGxpdC5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgICAgICB1bmlmb3JtLmlzU3RydWN0QXJyYXkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHVuaWZvcm0uc3RydWN0SW5kZXggPSBOdW1iZXIoc3BsaXRbMV0pO1xuICAgICAgICAgICAgICAgIHVuaWZvcm0uc3RydWN0UHJvcGVydHkgPSBzcGxpdFsyXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3BsaXQubGVuZ3RoID09PSAyICYmIGlzTmFOKE51bWJlcihzcGxpdFsxXSkpKSB7XG4gICAgICAgICAgICAgICAgdW5pZm9ybS5pc1N0cnVjdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdW5pZm9ybS5zdHJ1Y3RQcm9wZXJ0eSA9IHNwbGl0WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IGFjdGl2ZSBhdHRyaWJ1dGUgbG9jYXRpb25zXG4gICAgICAgIHRoaXMuYXR0cmlidXRlTG9jYXRpb25zID0gbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCBsb2NhdGlvbnMgPSBbXTtcbiAgICAgICAgY29uc3QgbnVtQXR0cmlicyA9IGdsLmdldFByb2dyYW1QYXJhbWV0ZXIodGhpcy5wcm9ncmFtLCBnbC5BQ1RJVkVfQVRUUklCVVRFUyk7XG4gICAgICAgIGZvciAobGV0IGFJbmRleCA9IDA7IGFJbmRleCA8IG51bUF0dHJpYnM7IGFJbmRleCsrKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBnbC5nZXRBY3RpdmVBdHRyaWIodGhpcy5wcm9ncmFtLCBhSW5kZXgpO1xuICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbih0aGlzLnByb2dyYW0sIGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgIC8vIElnbm9yZSBzcGVjaWFsIGJ1aWx0LWluIGlucHV0cy4gZWcgZ2xfVmVydGV4SUQsIGdsX0luc3RhbmNlSURcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbiA9PT0gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgbG9jYXRpb25zW2xvY2F0aW9uXSA9IGF0dHJpYnV0ZS5uYW1lO1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVMb2NhdGlvbnMuc2V0KGF0dHJpYnV0ZSwgbG9jYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT3JkZXIgPSBsb2NhdGlvbnMuam9pbignJyk7XG4gICAgfVxuXG4gICAgc2V0QmxlbmRGdW5jKHNyYywgZHN0LCBzcmNBbHBoYSwgZHN0QWxwaGEpIHtcbiAgICAgICAgdGhpcy5ibGVuZEZ1bmMuc3JjID0gc3JjO1xuICAgICAgICB0aGlzLmJsZW5kRnVuYy5kc3QgPSBkc3Q7XG4gICAgICAgIHRoaXMuYmxlbmRGdW5jLnNyY0FscGhhID0gc3JjQWxwaGE7XG4gICAgICAgIHRoaXMuYmxlbmRGdW5jLmRzdEFscGhhID0gZHN0QWxwaGE7XG4gICAgICAgIGlmIChzcmMpIHRoaXMudHJhbnNwYXJlbnQgPSB0cnVlO1xuICAgIH1cblxuICAgIHNldEJsZW5kRXF1YXRpb24obW9kZVJHQiwgbW9kZUFscGhhKSB7XG4gICAgICAgIHRoaXMuYmxlbmRFcXVhdGlvbi5tb2RlUkdCID0gbW9kZVJHQjtcbiAgICAgICAgdGhpcy5ibGVuZEVxdWF0aW9uLm1vZGVBbHBoYSA9IG1vZGVBbHBoYTtcbiAgICB9XG5cbiAgICBhcHBseVN0YXRlKCkge1xuICAgICAgICBpZiAodGhpcy5kZXB0aFRlc3QpIHRoaXMuZ2wucmVuZGVyZXIuZW5hYmxlKHRoaXMuZ2wuREVQVEhfVEVTVCk7XG4gICAgICAgIGVsc2UgdGhpcy5nbC5yZW5kZXJlci5kaXNhYmxlKHRoaXMuZ2wuREVQVEhfVEVTVCk7XG5cbiAgICAgICAgaWYgKHRoaXMuY3VsbEZhY2UpIHRoaXMuZ2wucmVuZGVyZXIuZW5hYmxlKHRoaXMuZ2wuQ1VMTF9GQUNFKTtcbiAgICAgICAgZWxzZSB0aGlzLmdsLnJlbmRlcmVyLmRpc2FibGUodGhpcy5nbC5DVUxMX0ZBQ0UpO1xuXG4gICAgICAgIGlmICh0aGlzLmJsZW5kRnVuYy5zcmMpIHRoaXMuZ2wucmVuZGVyZXIuZW5hYmxlKHRoaXMuZ2wuQkxFTkQpO1xuICAgICAgICBlbHNlIHRoaXMuZ2wucmVuZGVyZXIuZGlzYWJsZSh0aGlzLmdsLkJMRU5EKTtcblxuICAgICAgICBpZiAodGhpcy5jdWxsRmFjZSkgdGhpcy5nbC5yZW5kZXJlci5zZXRDdWxsRmFjZSh0aGlzLmN1bGxGYWNlKTtcbiAgICAgICAgdGhpcy5nbC5yZW5kZXJlci5zZXRGcm9udEZhY2UodGhpcy5mcm9udEZhY2UpO1xuICAgICAgICB0aGlzLmdsLnJlbmRlcmVyLnNldERlcHRoTWFzayh0aGlzLmRlcHRoV3JpdGUpO1xuICAgICAgICB0aGlzLmdsLnJlbmRlcmVyLnNldERlcHRoRnVuYyh0aGlzLmRlcHRoRnVuYyk7XG4gICAgICAgIGlmICh0aGlzLmJsZW5kRnVuYy5zcmMpXG4gICAgICAgICAgICB0aGlzLmdsLnJlbmRlcmVyLnNldEJsZW5kRnVuYyh0aGlzLmJsZW5kRnVuYy5zcmMsIHRoaXMuYmxlbmRGdW5jLmRzdCwgdGhpcy5ibGVuZEZ1bmMuc3JjQWxwaGEsIHRoaXMuYmxlbmRGdW5jLmRzdEFscGhhKTtcbiAgICAgICAgdGhpcy5nbC5yZW5kZXJlci5zZXRCbGVuZEVxdWF0aW9uKHRoaXMuYmxlbmRFcXVhdGlvbi5tb2RlUkdCLCB0aGlzLmJsZW5kRXF1YXRpb24ubW9kZUFscGhhKTtcbiAgICB9XG5cbiAgICB1c2UoeyBmbGlwRmFjZXMgPSBmYWxzZSB9ID0ge30pIHtcbiAgICAgICAgbGV0IHRleHR1cmVVbml0ID0gLTE7XG4gICAgICAgIGNvbnN0IHByb2dyYW1BY3RpdmUgPSB0aGlzLmdsLnJlbmRlcmVyLnN0YXRlLmN1cnJlbnRQcm9ncmFtID09PSB0aGlzLmlkO1xuXG4gICAgICAgIC8vIEF2b2lkIGdsIGNhbGwgaWYgcHJvZ3JhbSBhbHJlYWR5IGluIHVzZVxuICAgICAgICBpZiAoIXByb2dyYW1BY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuZ2wudXNlUHJvZ3JhbSh0aGlzLnByb2dyYW0pO1xuICAgICAgICAgICAgdGhpcy5nbC5yZW5kZXJlci5zdGF0ZS5jdXJyZW50UHJvZ3JhbSA9IHRoaXMuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgb25seSB0aGUgYWN0aXZlIHVuaWZvcm1zIGZvdW5kIGluIHRoZSBzaGFkZXJcbiAgICAgICAgdGhpcy51bmlmb3JtTG9jYXRpb25zLmZvckVhY2goKGxvY2F0aW9uLCBhY3RpdmVVbmlmb3JtKSA9PiB7XG4gICAgICAgICAgICBsZXQgbmFtZSA9IGFjdGl2ZVVuaWZvcm0udW5pZm9ybU5hbWU7XG5cbiAgICAgICAgICAgIC8vIGdldCBzdXBwbGllZCB1bmlmb3JtXG4gICAgICAgICAgICBsZXQgdW5pZm9ybSA9IHRoaXMudW5pZm9ybXNbbmFtZV07XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJ1Y3RzLCBnZXQgdGhlIHNwZWNpZmljIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGVudGlyZSBvYmplY3RcbiAgICAgICAgICAgIGlmIChhY3RpdmVVbmlmb3JtLmlzU3RydWN0KSB7XG4gICAgICAgICAgICAgICAgdW5pZm9ybSA9IHVuaWZvcm1bYWN0aXZlVW5pZm9ybS5zdHJ1Y3RQcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgbmFtZSArPSBgLiR7YWN0aXZlVW5pZm9ybS5zdHJ1Y3RQcm9wZXJ0eX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGl2ZVVuaWZvcm0uaXNTdHJ1Y3RBcnJheSkge1xuICAgICAgICAgICAgICAgIHVuaWZvcm0gPSB1bmlmb3JtW2FjdGl2ZVVuaWZvcm0uc3RydWN0SW5kZXhdW2FjdGl2ZVVuaWZvcm0uc3RydWN0UHJvcGVydHldO1xuICAgICAgICAgICAgICAgIG5hbWUgKz0gYFske2FjdGl2ZVVuaWZvcm0uc3RydWN0SW5kZXh9XS4ke2FjdGl2ZVVuaWZvcm0uc3RydWN0UHJvcGVydHl9YDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF1bmlmb3JtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdhcm4oYEFjdGl2ZSB1bmlmb3JtICR7bmFtZX0gaGFzIG5vdCBiZWVuIHN1cHBsaWVkYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh1bmlmb3JtICYmIHVuaWZvcm0udmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB3YXJuKGAke25hbWV9IHVuaWZvcm0gaXMgbWlzc2luZyBhIHZhbHVlIHBhcmFtZXRlcmApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodW5pZm9ybS52YWx1ZS50ZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgdGV4dHVyZVVuaXQgPSB0ZXh0dXJlVW5pdCArIDE7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0ZXh0dXJlIG5lZWRzIHRvIGJlIHVwZGF0ZWRcbiAgICAgICAgICAgICAgICB1bmlmb3JtLnZhbHVlLnVwZGF0ZSh0ZXh0dXJlVW5pdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldFVuaWZvcm0odGhpcy5nbCwgYWN0aXZlVW5pZm9ybS50eXBlLCBsb2NhdGlvbiwgdGV4dHVyZVVuaXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3IgdGV4dHVyZSBhcnJheXMsIHNldCB1bmlmb3JtIGFzIGFuIGFycmF5IG9mIHRleHR1cmUgdW5pdHMgaW5zdGVhZCBvZiBqdXN0IG9uZVxuICAgICAgICAgICAgaWYgKHVuaWZvcm0udmFsdWUubGVuZ3RoICYmIHVuaWZvcm0udmFsdWVbMF0udGV4dHVyZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHR1cmVVbml0cyA9IFtdO1xuICAgICAgICAgICAgICAgIHVuaWZvcm0udmFsdWUuZm9yRWFjaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dHVyZVVuaXQgPSB0ZXh0dXJlVW5pdCArIDE7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLnVwZGF0ZSh0ZXh0dXJlVW5pdCk7XG4gICAgICAgICAgICAgICAgICAgIHRleHR1cmVVbml0cy5wdXNoKHRleHR1cmVVbml0KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzZXRVbmlmb3JtKHRoaXMuZ2wsIGFjdGl2ZVVuaWZvcm0udHlwZSwgbG9jYXRpb24sIHRleHR1cmVVbml0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFVuaWZvcm0odGhpcy5nbCwgYWN0aXZlVW5pZm9ybS50eXBlLCBsb2NhdGlvbiwgdW5pZm9ybS52YWx1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYXBwbHlTdGF0ZSgpO1xuICAgICAgICBpZiAoZmxpcEZhY2VzKSB0aGlzLmdsLnJlbmRlcmVyLnNldEZyb250RmFjZSh0aGlzLmZyb250RmFjZSA9PT0gdGhpcy5nbC5DQ1cgPyB0aGlzLmdsLkNXIDogdGhpcy5nbC5DQ1cpO1xuICAgIH1cblxuICAgIHJlbW92ZSgpIHtcbiAgICAgICAgdGhpcy5nbC5kZWxldGVQcm9ncmFtKHRoaXMucHJvZ3JhbSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzZXRVbmlmb3JtKGdsLCB0eXBlLCBsb2NhdGlvbiwgdmFsdWUpIHtcbiAgICB2YWx1ZSA9IHZhbHVlLmxlbmd0aCA/IGZsYXR0ZW4odmFsdWUpIDogdmFsdWU7XG4gICAgY29uc3Qgc2V0VmFsdWUgPSBnbC5yZW5kZXJlci5zdGF0ZS51bmlmb3JtTG9jYXRpb25zLmdldChsb2NhdGlvbik7XG5cbiAgICAvLyBBdm9pZCByZWR1bmRhbnQgdW5pZm9ybSBjb21tYW5kc1xuICAgIGlmICh2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgaWYgKHNldFZhbHVlID09PSB1bmRlZmluZWQgfHwgc2V0VmFsdWUubGVuZ3RoICE9PSB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIGNsb25lIGFycmF5IHRvIHN0b3JlIGFzIGNhY2hlXG4gICAgICAgICAgICBnbC5yZW5kZXJlci5zdGF0ZS51bmlmb3JtTG9jYXRpb25zLnNldChsb2NhdGlvbiwgdmFsdWUuc2xpY2UoMCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGFycmF5c0VxdWFsKHNldFZhbHVlLCB2YWx1ZSkpIHJldHVybjtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGNhY2hlZCBhcnJheSB2YWx1ZXNcbiAgICAgICAgICAgIHNldFZhbHVlLnNldCA/IHNldFZhbHVlLnNldCh2YWx1ZSkgOiBzZXRBcnJheShzZXRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgZ2wucmVuZGVyZXIuc3RhdGUudW5pZm9ybUxvY2F0aW9ucy5zZXQobG9jYXRpb24sIHNldFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChzZXRWYWx1ZSA9PT0gdmFsdWUpIHJldHVybjtcbiAgICAgICAgZ2wucmVuZGVyZXIuc3RhdGUudW5pZm9ybUxvY2F0aW9ucy5zZXQobG9jYXRpb24sIHZhbHVlKTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSA1MTI2OlxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmxlbmd0aCA/IGdsLnVuaWZvcm0xZnYobG9jYXRpb24sIHZhbHVlKSA6IGdsLnVuaWZvcm0xZihsb2NhdGlvbiwgdmFsdWUpOyAvLyBGTE9BVFxuICAgICAgICBjYXNlIDM1NjY0OlxuICAgICAgICAgICAgcmV0dXJuIGdsLnVuaWZvcm0yZnYobG9jYXRpb24sIHZhbHVlKTsgLy8gRkxPQVRfVkVDMlxuICAgICAgICBjYXNlIDM1NjY1OlxuICAgICAgICAgICAgcmV0dXJuIGdsLnVuaWZvcm0zZnYobG9jYXRpb24sIHZhbHVlKTsgLy8gRkxPQVRfVkVDM1xuICAgICAgICBjYXNlIDM1NjY2OlxuICAgICAgICAgICAgcmV0dXJuIGdsLnVuaWZvcm00ZnYobG9jYXRpb24sIHZhbHVlKTsgLy8gRkxPQVRfVkVDNFxuICAgICAgICBjYXNlIDM1NjcwOiAvLyBCT09MXG4gICAgICAgIGNhc2UgNTEyNDogLy8gSU5UXG4gICAgICAgIGNhc2UgMzU2Nzg6IC8vIFNBTVBMRVJfMkRcbiAgICAgICAgY2FzZSAzNTY4MDpcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPyBnbC51bmlmb3JtMWl2KGxvY2F0aW9uLCB2YWx1ZSkgOiBnbC51bmlmb3JtMWkobG9jYXRpb24sIHZhbHVlKTsgLy8gU0FNUExFUl9DVUJFXG4gICAgICAgIGNhc2UgMzU2NzE6IC8vIEJPT0xfVkVDMlxuICAgICAgICBjYXNlIDM1NjY3OlxuICAgICAgICAgICAgcmV0dXJuIGdsLnVuaWZvcm0yaXYobG9jYXRpb24sIHZhbHVlKTsgLy8gSU5UX1ZFQzJcbiAgICAgICAgY2FzZSAzNTY3MjogLy8gQk9PTF9WRUMzXG4gICAgICAgIGNhc2UgMzU2Njg6XG4gICAgICAgICAgICByZXR1cm4gZ2wudW5pZm9ybTNpdihsb2NhdGlvbiwgdmFsdWUpOyAvLyBJTlRfVkVDM1xuICAgICAgICBjYXNlIDM1NjczOiAvLyBCT09MX1ZFQzRcbiAgICAgICAgY2FzZSAzNTY2OTpcbiAgICAgICAgICAgIHJldHVybiBnbC51bmlmb3JtNGl2KGxvY2F0aW9uLCB2YWx1ZSk7IC8vIElOVF9WRUM0XG4gICAgICAgIGNhc2UgMzU2NzQ6XG4gICAgICAgICAgICByZXR1cm4gZ2wudW5pZm9ybU1hdHJpeDJmdihsb2NhdGlvbiwgZmFsc2UsIHZhbHVlKTsgLy8gRkxPQVRfTUFUMlxuICAgICAgICBjYXNlIDM1Njc1OlxuICAgICAgICAgICAgcmV0dXJuIGdsLnVuaWZvcm1NYXRyaXgzZnYobG9jYXRpb24sIGZhbHNlLCB2YWx1ZSk7IC8vIEZMT0FUX01BVDNcbiAgICAgICAgY2FzZSAzNTY3NjpcbiAgICAgICAgICAgIHJldHVybiBnbC51bmlmb3JtTWF0cml4NGZ2KGxvY2F0aW9uLCBmYWxzZSwgdmFsdWUpOyAvLyBGTE9BVF9NQVQ0XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhZGRMaW5lTnVtYmVycyhzdHJpbmcpIHtcbiAgICBsZXQgbGluZXMgPSBzdHJpbmcuc3BsaXQoJ1xcbicpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGluZXNbaV0gPSBpICsgMSArICc6ICcgKyBsaW5lc1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xufVxuXG5mdW5jdGlvbiBmbGF0dGVuKGEpIHtcbiAgICBjb25zdCBhcnJheUxlbiA9IGEubGVuZ3RoO1xuICAgIGNvbnN0IHZhbHVlTGVuID0gYVswXS5sZW5ndGg7XG4gICAgaWYgKHZhbHVlTGVuID09PSB1bmRlZmluZWQpIHJldHVybiBhO1xuICAgIGNvbnN0IGxlbmd0aCA9IGFycmF5TGVuICogdmFsdWVMZW47XG4gICAgbGV0IHZhbHVlID0gYXJyYXlDYWNoZUYzMltsZW5ndGhdO1xuICAgIGlmICghdmFsdWUpIGFycmF5Q2FjaGVGMzJbbGVuZ3RoXSA9IHZhbHVlID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlMZW47IGkrKykgdmFsdWUuc2V0KGFbaV0sIGkgKiB2YWx1ZUxlbik7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5mdW5jdGlvbiBhcnJheXNFcXVhbChhLCBiKSB7XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFbaV0gIT09IGJbaV0pIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHNldEFycmF5KGEsIGIpIHtcbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGFbaV0gPSBiW2ldO1xuICAgIH1cbn1cblxubGV0IHdhcm5Db3VudCA9IDA7XG5mdW5jdGlvbiB3YXJuKG1lc3NhZ2UpIHtcbiAgICBpZiAod2FybkNvdW50ID4gMTAwKSByZXR1cm47XG4gICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuICAgIHdhcm5Db3VudCsrO1xuICAgIGlmICh3YXJuQ291bnQgPiAxMDApIGNvbnNvbGUud2FybignTW9yZSB0aGFuIDEwMCBwcm9ncmFtIHdhcm5pbmdzIC0gc3RvcHBpbmcgbG9ncy4nKTtcbn1cbiIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcIjUwMzFjNjE0ODEyZWU5NjkwNGVmXCIpIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiZWxlbWVudCIsInRoaXMiLCJjcmVhdGVUZXh0dXJlIiwiY3JlYXRlUHJvZ3JhbSIsIlByb2dyYW0iLCJjcmVhdGVNZXNoIiwiSUQiLCJhcnJheUNhY2hlRjMyIiwiZ2wiLCJ2ZXJ0ZXgiLCJmcmFnbWVudCIsInVuaWZvcm1zIiwidHJhbnNwYXJlbnQiLCJjdWxsRmFjZSIsIkJBQ0siLCJmcm9udEZhY2UiLCJDQ1ciLCJkZXB0aFRlc3QiLCJkZXB0aFdyaXRlIiwiZGVwdGhGdW5jIiwiTEVTUyIsImNhbnZhcyIsImNvbnNvbGUiLCJlcnJvciIsImlkIiwid2FybiIsImJsZW5kRnVuYyIsImJsZW5kRXF1YXRpb24iLCJzcmMiLCJyZW5kZXJlciIsInByZW11bHRpcGxpZWRBbHBoYSIsInNldEJsZW5kRnVuYyIsIk9ORSIsIk9ORV9NSU5VU19TUkNfQUxQSEEiLCJTUkNfQUxQSEEiLCJ2ZXJ0ZXhTaGFkZXIiLCJjcmVhdGVTaGFkZXIiLCJWRVJURVhfU0hBREVSIiwic2hhZGVyU291cmNlIiwiY29tcGlsZVNoYWRlciIsImdldFNoYWRlckluZm9Mb2ciLCJhZGRMaW5lTnVtYmVycyIsImZyYWdtZW50U2hhZGVyIiwiRlJBR01FTlRfU0hBREVSIiwicHJvZ3JhbSIsImF0dGFjaFNoYWRlciIsImxpbmtQcm9ncmFtIiwiZ2V0UHJvZ3JhbVBhcmFtZXRlciIsIkxJTktfU1RBVFVTIiwiZ2V0UHJvZ3JhbUluZm9Mb2ciLCJkZWxldGVTaGFkZXIiLCJ1bmlmb3JtTG9jYXRpb25zIiwiTWFwIiwibnVtVW5pZm9ybXMiLCJBQ1RJVkVfVU5JRk9STVMiLCJ1SW5kZXgiLCJ1bmlmb3JtIiwiZ2V0QWN0aXZlVW5pZm9ybSIsInNldCIsImdldFVuaWZvcm1Mb2NhdGlvbiIsIm5hbWUiLCJzcGxpdCIsIm1hdGNoIiwidW5pZm9ybU5hbWUiLCJsZW5ndGgiLCJpc1N0cnVjdEFycmF5Iiwic3RydWN0SW5kZXgiLCJOdW1iZXIiLCJzdHJ1Y3RQcm9wZXJ0eSIsImlzTmFOIiwiaXNTdHJ1Y3QiLCJhdHRyaWJ1dGVMb2NhdGlvbnMiLCJsb2NhdGlvbnMiLCJudW1BdHRyaWJzIiwiQUNUSVZFX0FUVFJJQlVURVMiLCJhSW5kZXgiLCJhdHRyaWJ1dGUiLCJnZXRBY3RpdmVBdHRyaWIiLCJsb2NhdGlvbiIsImdldEF0dHJpYkxvY2F0aW9uIiwiYXR0cmlidXRlT3JkZXIiLCJqb2luIiwiZHN0Iiwic3JjQWxwaGEiLCJkc3RBbHBoYSIsInNldEJsZW5kRXF1YXRpb24iLCJtb2RlUkdCIiwibW9kZUFscGhhIiwiYXBwbHlTdGF0ZSIsImVuYWJsZSIsIkRFUFRIX1RFU1QiLCJkaXNhYmxlIiwiQ1VMTF9GQUNFIiwiQkxFTkQiLCJzZXRDdWxsRmFjZSIsInNldEZyb250RmFjZSIsInNldERlcHRoTWFzayIsInNldERlcHRoRnVuYyIsInVzZSIsImZsaXBGYWNlcyIsInRleHR1cmVVbml0Iiwic3RhdGUiLCJjdXJyZW50UHJvZ3JhbSIsInVzZVByb2dyYW0iLCJmb3JFYWNoIiwiYWN0aXZlVW5pZm9ybSIsInVuZGVmaW5lZCIsInZhbHVlIiwidGV4dHVyZSIsInVwZGF0ZSIsInNldFVuaWZvcm0iLCJ0eXBlIiwidGV4dHVyZVVuaXRzIiwicHVzaCIsIkNXIiwicmVtb3ZlIiwiZGVsZXRlUHJvZ3JhbSIsImEiLCJhcnJheUxlbiIsInZhbHVlTGVuIiwiRmxvYXQzMkFycmF5IiwiaSIsImZsYXR0ZW4iLCJzZXRWYWx1ZSIsImdldCIsInNsaWNlIiwiYiIsImwiLCJhcnJheXNFcXVhbCIsInNldEFycmF5IiwidW5pZm9ybTFmdiIsInVuaWZvcm0xZiIsInVuaWZvcm0yZnYiLCJ1bmlmb3JtM2Z2IiwidW5pZm9ybTRmdiIsInVuaWZvcm0xaXYiLCJ1bmlmb3JtMWkiLCJ1bmlmb3JtMml2IiwidW5pZm9ybTNpdiIsInVuaWZvcm00aXYiLCJ1bmlmb3JtTWF0cml4MmZ2IiwidW5pZm9ybU1hdHJpeDNmdiIsInVuaWZvcm1NYXRyaXg0ZnYiLCJzdHJpbmciLCJsaW5lcyIsIndhcm5Db3VudCIsIm1lc3NhZ2UiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiaCJdLCJzb3VyY2VSb290IjoiIn0=