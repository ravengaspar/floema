/*! For license information please see main.e44eb2c78692690876ae.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatefloema("main",{"./app/components/Canvas/Collections/index.js":(t,s,e)=>{e.r(s),e.d(s,{default:()=>h});var i=e("./node_modules/ogl/src/core/Transform.js"),l=e("./node_modules/ogl/src/extras/Plane.js"),o=e("./node_modules/gsap/index.js"),r=e("./node_modules/prefix/index.js"),n=e("./node_modules/lodash/map.js"),a=e("./app/components/Canvas/Collections/Media.js"),c=e("./node_modules/console-browserify/index.js");const h=class{constructor({gl:t,scene:s,sizes:e,transition:l}){this.id="collections",this.gl=t,this.scene=s,this.sizes=e,this.transition=l,this.transformPrefix=r("transform"),this.group=new i.Transform,this.galleryElement=document.querySelector(".collections__gallery"),this.galleryWrapperElement=document.querySelector(".collections__gallery__wrapper"),this.titlesElement=document.querySelector(".collections__titles"),this.collectionsElements=document.querySelectorAll(".collections__article"),this.collectionsElementsActive="collections__article--active",this.mediasElements=document.querySelectorAll(".collections__gallery__media"),this.scroll={current:0,start:0,target:0,lerp:.1,velocity:1},this.createGeometry(),this.createGallery(),this.onResize({sizes:this.sizes}),this.group.setParent(this.scene),this.show()}createGeometry(){this.geometry=new l.Plane(this.gl)}createGallery(){this.medias=n(this.mediasElements,((t,s)=>new a.default({element:t,geometry:this.geometry,index:s,gl:this.gl,scene:this.group,sizes:this.sizes})))}async show(){if(this.transition){const{src:t}=this.transition.mesh.program.uniforms.tMap.value.image,s=window.TEXTURES[t],e=this.medias.find((t=>t.texture===s)),i=-e.bounds.left-e.bounds.width/2+window.innerWidth/2;this.update(),this.transition.animate({position:{x:0,y:e.mesh.position.y,z:0},rotation:e.mesh.rotation,scale:e.mesh.scale},(t=>{e.opacity.multiplier=1,n(this.medias,(t=>{e!==t&&t.show()})),this.scroll.current=this.scroll.target=this.scroll.start=this.scroll.last=i}))}else n(this.medias,(t=>t.show()))}hide(){n(this.medias,(t=>t.hide()))}onResize(t){this.sizes=t.sizes,this.bounds=this.galleryWrapperElement.getBoundingClientRect(),this.scroll.last=this.scroll.target=0,n(this.medias,(s=>s.onResize(t,this.scroll))),c.log(this.medias)}onTouchDown({x:t,y:s}){this.scroll.last=this.scroll.current}onTouchMove({x:t,y:s}){const e=t.start-t.end;this.scroll.target=this.scroll.last-e}onTouchUp({x:t,y:s}){}onWheel({pixelY:t}){this.scroll.target+=t}onChange(t){this.index=t;const s=parseInt(this.mediasElements[this.index].getAttribute("data-index"));n(this.collectionsElements,((t,e)=>{e===s?t.classList.add(this.collectionsElementsActive):t.classList.remove(this.collectionsElementsActive)})),this.titlesElement.style[this.transformPrefix]=`translateY(-${25*s}%) translate(-50%, -50%) rotate(-90deg)`}update(){this.scroll.target=o.default.utils.clamp(-this.scroll.limit,0,this.scroll.target),this.scroll.current=o.default.utils.interpolate(this.scroll.current,this.scroll.target,this.scroll.lerp),this.galleryElement.style[this.transformPrefix]=`translateX(${this.scroll.current}px)`,this.scroll.last<this.scroll.current?this.scroll.direction="right":this.scroll.last>this.scroll.current&&(this.scroll.direction="left"),this.scroll.last=this.scroll.current;const t=Math.floor(Math.abs((this.scroll.current-this.medias[0].bounds.width/2)/this.scroll.limit)*(this.medias.length-1));this.index!==t&&this.onChange(t),n(this.medias,((t,s)=>{t.update(this.scroll.current,this.index),t.mesh.rotation.z=Math.abs(o.default.utils.mapRange(0,1,-.2,.2,s/(this.medias.length-1)))-.1,t.mesh.position.y+=40*Math.cos(t.mesh.position.x/this.sizes.width*Math.PI*.1)-40}))}destroy(){this.scene.removeChild(this.group)}}}},(function(t){t.h=()=>"e619f32e9e371e0d3826"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBS2UsT0FBT0MsVUFDekNoQixLQUFLZSxPQUFPc0UsVUFBWSxRQUd6QnJGLEtBQUtlLE9BQU84QyxLQUFPN0QsS0FBS2UsT0FBT0MsUUFFL0IsTUFBTWUsRUFBUXVELEtBQUtDLE1BQU9ELEtBQUtFLEtBQU14RixLQUFLZSxPQUFPQyxRQUFVaEIsS0FBSzRCLE9BQU8sR0FBR2lCLE9BQU9FLE1BQVEsR0FBSy9DLEtBQUtlLE9BQU9xRSxRQUFXcEYsS0FBSzRCLE9BQU82RCxPQUFTLElBRXRJekYsS0FBSytCLFFBQVVBLEdBQ2xCL0IsS0FBSzBFLFNBQVMzQyxHQUdmRixFQUFJN0IsS0FBSzRCLFFBQVEsQ0FBQ2UsRUFBT1osS0FDckJZLEVBQU1NLE9BQU9qRCxLQUFLZSxPQUFPQyxRQUFTaEIsS0FBSytCLE9BQ3ZDWSxFQUFNVCxLQUFLcUIsU0FBU0QsRUFBSWdDLEtBQUtFLElBQUtMLEVBQUFBLFFBQUFBLE1BQUFBLFNBQW9CLEVBQUcsR0FBSSxHQUFLLEdBQUtwRCxHQUFTL0IsS0FBSzRCLE9BQU82RCxPQUFTLEtBQVEsR0FFN0c5QyxFQUFNVCxLQUFLaUIsU0FBU0UsR0FBNEUsR0FBdkVpQyxLQUFLSSxJQUFLL0MsRUFBTVQsS0FBS2lCLFNBQVNDLEVBQUlwRCxLQUFLRixNQUFNaUQsTUFBU3VDLEtBQUtLLEdBQUssSUFBWSxFQUFyRyxHQUNKLENBS0RDLFVBQ0M1RixLQUFLSCxNQUFNZ0csWUFBWTdGLEtBQUtJLE1BQzVCLGtCQzFNRjBGLEVBQW9CQyxFQUFJLElBQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbG9lbWEvLi9hcHAvY29tcG9uZW50cy9DYW52YXMvQ29sbGVjdGlvbnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZmxvZW1hL3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQbGFuZSwgVHJhbnNmb3JtIH0gZnJvbSAnb2dsJ1xuaW1wb3J0IEdTQVAgZnJvbSAnZ3NhcCdcbmltcG9ydCBQcmVmaXggZnJvbSAncHJlZml4J1xuXG5pbXBvcnQgbWFwIGZyb20gJ2xvZGFzaC9tYXAnXG5cbmltcG9ydCBNZWRpYSBmcm9tICcuL01lZGlhJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB7XG5cdGNvbnN0cnVjdG9yKHsgZ2wsIHNjZW5lLCBzaXplcywgdHJhbnNpdGlvbiB9KSB7XG5cdFx0dGhpcy5pZCA9ICdjb2xsZWN0aW9ucydcblxuXHRcdHRoaXMuZ2wgPSBnbFxuXHRcdHRoaXMuc2NlbmUgPSBzY2VuZVxuXHRcdHRoaXMuc2l6ZXMgPSBzaXplc1xuXHRcdHRoaXMudHJhbnNpdGlvbiA9IHRyYW5zaXRpb25cblxuXHRcdHRoaXMudHJhbnNmb3JtUHJlZml4ID0gUHJlZml4KCd0cmFuc2Zvcm0nKVxuXG5cdFx0dGhpcy5ncm91cCA9IG5ldyBUcmFuc2Zvcm0oKVxuXG5cdFx0dGhpcy5nYWxsZXJ5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2xsZWN0aW9uc19fZ2FsbGVyeScpXG5cdFx0dGhpcy5nYWxsZXJ5V3JhcHBlckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCAnLmNvbGxlY3Rpb25zX19nYWxsZXJ5X193cmFwcGVyJyApOyAvLyBwcmV0dGllci1pZ25vcmVcblxuXHRcdHRoaXMudGl0bGVzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2xsZWN0aW9uc19fdGl0bGVzJylcblxuXHRcdHRoaXMuY29sbGVjdGlvbnNFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICcuY29sbGVjdGlvbnNfX2FydGljbGUnICk7IC8vIHByZXR0aWVyLWlnbm9yZVxuXHRcdHRoaXMuY29sbGVjdGlvbnNFbGVtZW50c0FjdGl2ZSA9ICdjb2xsZWN0aW9uc19fYXJ0aWNsZS0tYWN0aXZlJ1xuXG5cdFx0dGhpcy5tZWRpYXNFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICcuY29sbGVjdGlvbnNfX2dhbGxlcnlfX21lZGlhJyApOyAvLyBwcmV0dGllci1pZ25vcmVcblxuXHRcdHRoaXMuc2Nyb2xsID0ge1xuXHRcdFx0Y3VycmVudDogMCxcblx0XHRcdHN0YXJ0OiAwLFxuXHRcdFx0dGFyZ2V0OiAwLFxuXHRcdFx0bGVycDogMC4xLFxuXHRcdFx0dmVsb2NpdHk6IDEsXG5cdFx0fVxuXG5cdFx0dGhpcy5jcmVhdGVHZW9tZXRyeSgpXG5cdFx0dGhpcy5jcmVhdGVHYWxsZXJ5KClcblxuXHRcdHRoaXMub25SZXNpemUoe1xuXHRcdFx0c2l6ZXM6IHRoaXMuc2l6ZXMsXG5cdFx0fSlcblxuXHRcdHRoaXMuZ3JvdXAuc2V0UGFyZW50KHRoaXMuc2NlbmUpXG5cblx0XHR0aGlzLnNob3coKVxuXHR9XG5cblx0Y3JlYXRlR2VvbWV0cnkoKSB7XG5cdFx0dGhpcy5nZW9tZXRyeSA9IG5ldyBQbGFuZSh0aGlzLmdsKVxuXHR9XG5cblx0Y3JlYXRlR2FsbGVyeSgpIHtcblx0XHR0aGlzLm1lZGlhcyA9IG1hcCh0aGlzLm1lZGlhc0VsZW1lbnRzLCAoZWxlbWVudCwgaW5kZXgpID0+IHtcblx0XHRcdHJldHVybiBuZXcgTWVkaWEoe1xuXHRcdFx0XHRlbGVtZW50LFxuXHRcdFx0XHRnZW9tZXRyeTogdGhpcy5nZW9tZXRyeSxcblx0XHRcdFx0aW5kZXgsXG5cdFx0XHRcdGdsOiB0aGlzLmdsLFxuXHRcdFx0XHRzY2VuZTogdGhpcy5ncm91cCxcblx0XHRcdFx0c2l6ZXM6IHRoaXMuc2l6ZXMsXG5cdFx0XHR9KVxuXHRcdH0pXG5cdH1cblxuXHQvKipcblx0ICogQW5pbWF0aW9ucy5cblx0ICovXG5cdGFzeW5jIHNob3coKSB7XG5cdFx0aWYgKHRoaXMudHJhbnNpdGlvbikge1xuXHRcdFx0Y29uc3QgeyBzcmMgfSA9IHRoaXMudHJhbnNpdGlvbi5tZXNoLnByb2dyYW0udW5pZm9ybXMudE1hcC52YWx1ZS5pbWFnZVxuXHRcdFx0Y29uc3QgdGV4dHVyZSA9IHdpbmRvdy5URVhUVVJFU1tzcmNdXG5cdFx0XHRjb25zdCBtZWRpYSA9IHRoaXMubWVkaWFzLmZpbmQobWVkaWEgPT4gbWVkaWEudGV4dHVyZSA9PT0gdGV4dHVyZSlcblx0XHRcdGNvbnN0IHNjcm9sbCA9IC1tZWRpYS5ib3VuZHMubGVmdCAtIG1lZGlhLmJvdW5kcy53aWR0aCAvIDIgKyB3aW5kb3cuaW5uZXJXaWR0aCAvIDI7IC8vIHByZXR0aWVyLWlnbm9yZVxuXG5cdFx0XHR0aGlzLnVwZGF0ZSgpXG5cblx0XHRcdHRoaXMudHJhbnNpdGlvbi5hbmltYXRlKFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cG9zaXRpb246IHsgeDogMCwgeTogbWVkaWEubWVzaC5wb3NpdGlvbi55LCB6OiAwIH0sXG5cdFx0XHRcdFx0cm90YXRpb246IG1lZGlhLm1lc2gucm90YXRpb24sXG5cdFx0XHRcdFx0c2NhbGU6IG1lZGlhLm1lc2guc2NhbGUsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdF8gPT4ge1xuXHRcdFx0XHRcdG1lZGlhLm9wYWNpdHkubXVsdGlwbGllciA9IDFcblxuXHRcdFx0XHRcdG1hcCh0aGlzLm1lZGlhcywgaXRlbSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAobWVkaWEgIT09IGl0ZW0pIHtcblx0XHRcdFx0XHRcdFx0aXRlbS5zaG93KClcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXG5cdFx0XHRcdFx0dGhpcy5zY3JvbGwuY3VycmVudCA9IHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLnN0YXJ0ID0gdGhpcy5zY3JvbGwubGFzdCA9IHNjcm9sbDsgLy8gcHJldHRpZXItaWdub3JlXG5cdFx0XHRcdH1cblx0XHRcdClcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWFwKHRoaXMubWVkaWFzLCBtZWRpYSA9PiBtZWRpYS5zaG93KCkpXG5cdFx0fVxuXHR9XG5cblx0aGlkZSgpIHtcblx0XHRtYXAodGhpcy5tZWRpYXMsIG1lZGlhID0+IG1lZGlhLmhpZGUoKSlcblx0fVxuXG5cdC8qKlxuXHQgKiBFdmVudHMuXG5cdCAqL1xuXHRvblJlc2l6ZShldmVudCkge1xuXHRcdHRoaXMuc2l6ZXMgPSBldmVudC5zaXplc1xuXG5cdFx0dGhpcy5ib3VuZHMgPSB0aGlzLmdhbGxlcnlXcmFwcGVyRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXG5cdFx0dGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLnRhcmdldCA9IDBcblxuXHRcdG1hcCh0aGlzLm1lZGlhcywgbWVkaWEgPT4gbWVkaWEub25SZXNpemUoZXZlbnQsIHRoaXMuc2Nyb2xsKSlcblxuXHRcdGNvbnNvbGUubG9nKHRoaXMubWVkaWFzKVxuXG5cdFx0Ly8gdGhpcy5zY3JvbGwubGltaXQgPSB0aGlzLmJvdW5kcy53aWR0aCAtIHRoaXMubWVkaWFzWzBdLmVsZW1lbnQuY2xpZW50V2lkdGhcblx0fVxuXG5cdG9uVG91Y2hEb3duKHsgeCwgeSB9KSB7XG5cdFx0dGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLmN1cnJlbnRcblx0fVxuXG5cdG9uVG91Y2hNb3ZlKHsgeCwgeSB9KSB7XG5cdFx0Y29uc3QgZGlzdGFuY2UgPSB4LnN0YXJ0IC0geC5lbmRcblxuXHRcdHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLmxhc3QgLSBkaXN0YW5jZVxuXHR9XG5cblx0b25Ub3VjaFVwKHsgeCwgeSB9KSB7fVxuXG5cdG9uV2hlZWwoeyBwaXhlbFkgfSkge1xuXHRcdHRoaXMuc2Nyb2xsLnRhcmdldCArPSBwaXhlbFlcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGFuZ2VkLlxuXHQgKi9cblx0b25DaGFuZ2UoaW5kZXgpIHtcblx0XHR0aGlzLmluZGV4ID0gaW5kZXhcblxuXG4gICAgXG5cblx0XHRjb25zdCBzZWxlY3RlZENvbGxlY3Rpb24gPSBwYXJzZUludCh0aGlzLm1lZGlhc0VsZW1lbnRzW3RoaXMuaW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcpKVxuXG5cdFx0bWFwKHRoaXMuY29sbGVjdGlvbnNFbGVtZW50cywgKGVsZW1lbnQsIGVsZW1lbnRJbmRleCkgPT4ge1xuXHRcdFx0aWYgKGVsZW1lbnRJbmRleCA9PT0gc2VsZWN0ZWRDb2xsZWN0aW9uKSB7XG5cdFx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUpXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzQWN0aXZlKVxuXHRcdFx0fVxuXHRcdH0pXG5cblx0XHR0aGlzLnRpdGxlc0VsZW1lbnQuc3R5bGVbdGhpcy50cmFuc2Zvcm1QcmVmaXhdID0gYHRyYW5zbGF0ZVkoLSR7IDI1ICogc2VsZWN0ZWRDb2xsZWN0aW9uIH0lKSB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKC05MGRlZylgOyAvLyBwcmV0dGllci1pZ25vcmVcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUuXG5cdCAqL1xuXHR1cGRhdGUoKSB7XG5cdFx0dGhpcy5zY3JvbGwudGFyZ2V0ID0gR1NBUC51dGlscy5jbGFtcCgtdGhpcy5zY3JvbGwubGltaXQsIDAsIHRoaXMuc2Nyb2xsLnRhcmdldClcblxuXHRcdHRoaXMuc2Nyb2xsLmN1cnJlbnQgPSBHU0FQLnV0aWxzLmludGVycG9sYXRlKFxuXHRcdFx0dGhpcy5zY3JvbGwuY3VycmVudCxcblx0XHRcdHRoaXMuc2Nyb2xsLnRhcmdldCxcblx0XHRcdHRoaXMuc2Nyb2xsLmxlcnBcblx0XHQpXG5cblx0XHR0aGlzLmdhbGxlcnlFbGVtZW50LnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGB0cmFuc2xhdGVYKCR7dGhpcy5zY3JvbGwuY3VycmVudH1weClgXG5cblx0XHRpZiAodGhpcy5zY3JvbGwubGFzdCA8IHRoaXMuc2Nyb2xsLmN1cnJlbnQpIHtcblx0XHRcdHRoaXMuc2Nyb2xsLmRpcmVjdGlvbiA9ICdyaWdodCdcblx0XHR9IGVsc2UgaWYgKHRoaXMuc2Nyb2xsLmxhc3QgPiB0aGlzLnNjcm9sbC5jdXJyZW50KSB7XG5cdFx0XHR0aGlzLnNjcm9sbC5kaXJlY3Rpb24gPSAnbGVmdCdcblx0XHR9XG5cblx0XHR0aGlzLnNjcm9sbC5sYXN0ID0gdGhpcy5zY3JvbGwuY3VycmVudFxuXG5cdFx0Y29uc3QgaW5kZXggPSBNYXRoLmZsb29yKCBNYXRoLmFicyggKHRoaXMuc2Nyb2xsLmN1cnJlbnQgLSB0aGlzLm1lZGlhc1swXS5ib3VuZHMud2lkdGggLyAyKSAvIHRoaXMuc2Nyb2xsLmxpbWl0ICkgKiAodGhpcy5tZWRpYXMubGVuZ3RoIC0gMSkgKTsgLy8gcHJldHRpZXItaWdub3JlXG5cblx0XHRpZiAodGhpcy5pbmRleCAhPT0gaW5kZXgpIHtcblx0XHRcdHRoaXMub25DaGFuZ2UoaW5kZXgpXG5cdFx0fVxuXG5cdFx0bWFwKHRoaXMubWVkaWFzLCAobWVkaWEsIGluZGV4KSA9PiB7XG4gICAgICBtZWRpYS51cGRhdGUodGhpcy5zY3JvbGwuY3VycmVudCwgdGhpcy5pbmRleCk7XG4gICAgICBtZWRpYS5tZXNoLnJvdGF0aW9uLnogPSBNYXRoLmFicyggR1NBUC51dGlscy5tYXBSYW5nZSgwLCAxLCAtMC4yLCAwLjIsIGluZGV4IC8gKHRoaXMubWVkaWFzLmxlbmd0aCAtIDEpKSApIC0gMC4xOyAvLyBwcmV0dGllci1pZ25vcmVcblxuICAgICAgbWVkaWEubWVzaC5wb3NpdGlvbi55ICs9IE1hdGguY29zKChtZWRpYS5tZXNoLnBvc2l0aW9uLnggLyB0aGlzLnNpemVzLndpZHRoKSAqIE1hdGguUEkgKiAwLjEpICogNDAgLSA0MDsgfSk7IC8vIHByZXR0aWVyLWlnbm9yZVxuXHR9XG5cblx0LyoqXG5cdCAqIERlc3Ryb3kuXG5cdCAqL1xuXHRkZXN0cm95KCkge1xuXHRcdHRoaXMuc2NlbmUucmVtb3ZlQ2hpbGQodGhpcy5ncm91cClcblx0fVxufVxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5oID0gKCkgPT4gKFwiZTYxOWYzMmU5ZTM3MWUwZDM4MjZcIikiXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJnbCIsInNjZW5lIiwic2l6ZXMiLCJ0cmFuc2l0aW9uIiwidGhpcyIsImlkIiwidHJhbnNmb3JtUHJlZml4IiwiUHJlZml4IiwiZ3JvdXAiLCJUcmFuc2Zvcm0iLCJnYWxsZXJ5RWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImdhbGxlcnlXcmFwcGVyRWxlbWVudCIsInRpdGxlc0VsZW1lbnQiLCJjb2xsZWN0aW9uc0VsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUiLCJtZWRpYXNFbGVtZW50cyIsInNjcm9sbCIsImN1cnJlbnQiLCJzdGFydCIsInRhcmdldCIsImxlcnAiLCJ2ZWxvY2l0eSIsImNyZWF0ZUdlb21ldHJ5IiwiY3JlYXRlR2FsbGVyeSIsIm9uUmVzaXplIiwic2V0UGFyZW50Iiwic2hvdyIsImdlb21ldHJ5IiwiUGxhbmUiLCJtZWRpYXMiLCJtYXAiLCJlbGVtZW50IiwiaW5kZXgiLCJNZWRpYSIsInNyYyIsIm1lc2giLCJwcm9ncmFtIiwidW5pZm9ybXMiLCJ0TWFwIiwidmFsdWUiLCJpbWFnZSIsInRleHR1cmUiLCJ3aW5kb3ciLCJURVhUVVJFUyIsIm1lZGlhIiwiZmluZCIsImJvdW5kcyIsImxlZnQiLCJ3aWR0aCIsImlubmVyV2lkdGgiLCJ1cGRhdGUiLCJhbmltYXRlIiwicG9zaXRpb24iLCJ4IiwieSIsInoiLCJyb3RhdGlvbiIsInNjYWxlIiwiXyIsIm9wYWNpdHkiLCJtdWx0aXBsaWVyIiwiaXRlbSIsImxhc3QiLCJoaWRlIiwiZXZlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJjb25zb2xlIiwibG9nIiwib25Ub3VjaERvd24iLCJvblRvdWNoTW92ZSIsImRpc3RhbmNlIiwiZW5kIiwib25Ub3VjaFVwIiwib25XaGVlbCIsInBpeGVsWSIsIm9uQ2hhbmdlIiwic2VsZWN0ZWRDb2xsZWN0aW9uIiwicGFyc2VJbnQiLCJnZXRBdHRyaWJ1dGUiLCJlbGVtZW50SW5kZXgiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJzdHlsZSIsIkdTQVAiLCJsaW1pdCIsImRpcmVjdGlvbiIsIk1hdGgiLCJmbG9vciIsImFicyIsImxlbmd0aCIsImNvcyIsIlBJIiwiZGVzdHJveSIsInJlbW92ZUNoaWxkIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImgiXSwic291cmNlUm9vdCI6IiJ9